(function(){this.SPClient=function(){var n=!1;this.getListData=function(n,t,i,r,u){function s(){function y(){for(var s=h.getEnumerator(),c=t.split(","),a=[],u,f,e,i,o;s.moveNext();){for(u=s.get_current(),f={},e=0;e<c.length;e++)i=jQuery.trim(c[e]),l[i]==SP.FieldType.URL?u.get_item(i)!==null?(o={},o[descriptionFieldName]=u.get_item(i).get_description(),o[urlFieldName]=u.get_item(i).get_url(),f[i]=o):f[i]=null:f[i]=u.get_item(i);a.push(f)}r(a,t,n)}function p(t,i){i!=null&&typeof i!="undefined"&&(f=$.createErrorReason("getListData",i),$.displayConsoleLog(f),u(i.get_message(),n))}for(var l=[],a=o.getEnumerator(),c,v,s,h;a.moveNext();)c=a.get_current(),v=c.get_fieldTypeKind(),l[c.get_title()]=v;s=new SP.CamlQuery;$.isNullOrEmpty(i)?s=SP.CamlQuery.createAllItemsQuery():s.set_viewXml(i);h=e.getItems(s);t.length>0?clientContext.load(h,"Include("+t+")"):clientContext.load(h);clientContext.executeQueryAsync(y,p)}function h(t,i){i!=null&&typeof i!="undefined"&&(f=$.createErrorReason("getListData.onFailFields",i),$.displayConsoleLog(f),u(i.get_message(),n))}var f="",e,o;if($.isNullOrEmpty(n)){f='List name "'+n+'" is empty.';$.displayConsoleLog(f);return}e=webLists.getByTitle(n);o=e.get_fields();clientContext.load(o);clientContext.executeQueryAsync(s,h);this.isError=function(){return f.length>0?!0:!1};this.errorReason=function(){return f}};this.createOrUpdateListItem=function(n,t,i,r,u){function c(){r()}function l(r,e){f=$.createErrorReason("createOrUpdateListItem",e);$.displayConsoleLog(f);$.displayConsoleLog("listName: "+n);$.displayConsoleLog("listItemId: "+t);$.displayConsoleLog("jsonListData:- ");for(var o=0;o<i.data.length;o++)$.displayConsoleLog(i.data[o].fieldName+": "+i.data[o].fieldValue);e!=null&&typeof e!="undefined"&&u(r,e)}var f="",s,h,o,e;if($.isNullOrEmpty(n)){f='List name "'+n+'" is empty.';$.displayConsoleLog(f);return}for(s=webLists.getByTitle(n),h=new SP.ListItemCreationInformation,o=t>0?s.getItemById(t):s.addItem(h),e=0;e<i.data.length;e++)o.set_item(i.data[e].fieldName,i.data[e].fieldValue);o.update();clientContext.load(o);clientContext.executeQueryAsync(c,l);this.isError=function(){return f.length>0?!0:!1};this.errorReason=function(){return f}};this.deleteListData=function(n,t,i,r){function o(){i(t)}function s(n,t){t!=null&&typeof t!="undefined"&&(u=$.createErrorReason("deleteListData",t),$.displayConsoleLog(u),r(n,t))}var u="",f,e;if($.isNullOrEmpty(n)){u='List name "'+n+'" is empty.';$.displayConsoleLog(u);return}if(t<=0){u='List item Id cannot be "'+t+'"';$.displayConsoleLog(u);return}f=webLists.getByTitle(n);e=f.getItemById(t);e.deleteObject();clientContext.executeQueryAsync(o,s);this.isError=function(){return u.length>0?!0:!1};this.errorReason=function(){return u}};this.deleteAllListData=function(n,t,i){var r="";if($.isNullOrEmpty(n)){r='List name "'+n+'" is empty.';$.displayConsoleLog(r);return}var f=webLists.getByTitle(n),e=new SP.CamlQuery,u=f.getItems(e);clientContext.load(u,"Include(Id)");clientContext.executeQueryAsync(function(){function o(){t()}function s(n,t){t!=null&&typeof t!="undefined"&&(r=$.createErrorReason("deleteAllListData",t),$.displayConsoleLog(r),i(n,t))}for(var f=u.getEnumerator(),n=[],e;f.moveNext();)n.push(f.get_current());for(e in n)n[e].deleteObject();clientContext.executeQueryAsync(o,s)},function(){args!=null&&typeof args!="undefined"&&(r=$.createErrorReason("deleteAllListData.GetAllIDs",args),$.displayConsoleLog(r),i(sender,args))})};this.consoleLog=function(t){n=t;$.displayConsoleLog("console log enabled")};$.displayConsoleLog=function(t){n&&console.log(t)};$.isNullOrEmpty=function(n){switch(n){case null:case"":case typeof this=="undefined":return!0;default:return!1}};$.createErrorReason=function(n,t){var i="Error in function "+n;return(t!=null||typeof t!="undefined")&&(i+=". "+t.get_message()+" "+t.get_stackTrace()),i}}})()