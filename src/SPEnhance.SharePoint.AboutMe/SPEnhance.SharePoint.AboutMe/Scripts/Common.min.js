function consoleLog(n){consoleLogEnabled&&console.log(n)}function setCookie(n,t,i){var r=new Date;r.setTime(r.getTime()+i*864e5);document.cookie=n+"="+t+";expires="+r.toUTCString()+";path=/"}function getCookie(n){var t=document.cookie.match("(^|;) ?"+n+"=([^;]*)(;|$)");return t?t[2]:null}function getFieldsByListName(n){var t="";return angular.forEach(listNames.lists,function(i){if(i.listName==n)return angular.forEach(i.fields,function(n){t+=n.fieldInternalName+","}),!1}),t.substring(0,t.lastIndexOf(","))}function getFieldsObjectByListName(n){var t={};return angular.forEach(listNames.lists,function(i){i.listName==n&&(t=i.fields)}),t}function getListMaxRows(n){var t=-1;return angular.forEach(listNames.lists,function(i){if(i.listName==n&&i.maxRows!=null)return consoleLog(i.listName+" "+i.maxRows),t=i.maxRows,!1}),t}function getFieldTypeByListFieldInternalName(n,t){var i="";return angular.forEach(listNames.lists,function(r){if(r.listName==n)return consoleLog(r.listName+" "+JSON.stringify(r.fields)),angular.forEach(r.fields,function(n){return consoleLog(n.fieldType),n.fieldInternalName==t?(i=n.fieldType,!1):void 0}),consoleLog(i),!1}),i}function getFieldDisplayNameByListFieldInternalName(n,t){var i="";return angular.forEach(listNames.lists,function(r){if(r.listName==n)return consoleLog(r.listName+" "+JSON.stringify(r.fields)),angular.forEach(r.fields,function(n){return consoleLog(n.fieldType),n.fieldInternalName==t?(i=n.fieldDisplayName,!1):void 0}),consoleLog(i),!1}),i}function getListItemCount(n,t,i,r){function u(n){$("#"+r).text(n)}function f(n){consoleLog(n.get_message())}objClient.getListItemCount(n,t,i,u,f)}function showHideFooterMenu(n){var t=document.getElementById("footerMenu"),i=angular.element(t).scope();consoleLog("Going to show/hide footer menu: "+n);i.allListsCreated=n}function updateProgressBar(n){var t=document.getElementById("progressBar"),i=angular.element(t).scope();n=Math.round(n/listNames.lists.length*100,0);consoleLog("Going to update progressBar: "+n);i.progressBarValueNow=n}function showMsg(n){$("#spanMsg").html(n);$("#divMsg").show();setTimeout(function(){$("input[type='button']").removeAttr("disabled")},1e3)}function clearMsg(){$("#spanMsg").html("");$("#divMsg").hide()}function refreshPage(){window.location.reload(!0)}function createSingleList(n,t,i,r){angular.forEach(listNames.lists,function(u){if(u.listName==i){consoleLog("createList with listName: "+i);createList(n,t,i,u.fields,r);return}})}function createList(n,t,i,r,u){function f(i){consoleLog("List "+i+" created..");createListFields(n,t,i,r,u)}function e(n,t){consoleLog("Failed to create list "+t+". Error:"+n.get_message())}objClient.createList(n,t,i,f,e)}function createListFields(n,t,i,r,u){function f(i){u?(showMsg("List '"+i+"' has been created"),displayAllLists(n,t)):(i==overviewListName&&objClient.getListData(n,t,overviewListName,getFieldsByListName(overviewListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><RowLimit>1<\/RowLimit><\/View>",callbackOverviewSuccess,callbackFail),i==personalInfoListName&&objClient.getListData(n,t,personalInfoListName,getFieldsByListName(personalInfoListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><RowLimit>1<\/RowLimit><\/View>",callbackPersonalInfoSuccess,callbackFail),i==skillListName&&objClient.getListData(n,t,skillListName,getFieldsByListName(skillListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackSkillSuccess,callbackFail),i==certificationListName&&objClient.getListData(n,t,certificationListName,getFieldsByListName(certificationListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackCertificationSuccess,callbackFail),i==projectListName&&objClient.getListData(n,t,projectListName,getFieldsByListName(projectListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackProjectSuccess,callbackFail),i==experienceListName&&objClient.getListData(n,t,experienceListName,getFieldsByListName(experienceListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackExperienceSuccess,callbackFail),i==educationListName&&objClient.getListData(n,t,educationListName,getFieldsByListName(educationListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackEducationSuccess,callbackFail))}function e(n,t){u&&showMsg("Failed to create fields in list "+t+". Error:"+n.get_message());consoleLog("Failed to create fields in list "+t+". Error:"+n.get_message())}objClient.createListFields(n,t,i,r,excludeListFieldsToCreate,f,e)}function createAllLists(n,t){function i(){displayAllLists(n,t);showMsg("Lists have been created")}function r(n){consoleLog("Failed to create lists. Error:"+n.get_message())}objClient.createAllLists(n,t,listNames.lists,excludeListFieldsToCreate,i,r)}function displayAllLists(n,t){function i(n,i){for(var u,r="<ul class='list-group'>",f=0;f<listNames.lists.length;f++)u=listNames.lists[f].listName,getListItemCount(n,t,u,"listItemCount_"+u),r+="<li class='list-group-item'>",r+=u+" <span id='listItemCount_"+u+"' class='badge' style='float: none !important'><\/span>",r+="<span style='float:right'>",i.indexOf(listNames.lists[f].listName)>=0?(r+="<a class='deleteSingleList' data='"+u+"' ng-click='deleteList($event)'>Delete<\/a>",r+=" | ",r+="<a href='"+appWebUrl+"/Pages/Admin/List/View.aspx?listName="+u+"&SPAppWebUrl="+appWebUrl+"&SPHostUrl="+hostWebUrl+"'>Manage Data<\/a>"):r+="<a class='createSingleList' data='"+u+"' ng-click='createList($event)'>Create<\/a>",r+="<\/span>",r+="<\/li>";r+="<\/ul>";n.lists=r}function r(n){showMsg("Error in getting lists. Error is "+n.get_message())}objClient.displayAllLists(n,t,excludeListNames,i,r)}function deleteSingleList(n,t,i){angular.forEach(listNames.lists,function(r){if(r.listName==i){deleteList(n,t,i);return}})}function deleteList(n,t,i){function r(){displayAllLists(n,t);showMsg("List '"+i+"' has been deleted")}function u(n){showMsg("Failed to delete list "+i+". Error:"+n.get_message())}objClient.deleteList(n,t,i,r,u)}function deleteAllLists(n,t){function i(){displayAllLists(n,t);showMsg("Lists have been deleted")}function r(){showMsg("Could not delete all lists. Please try again later")}objClient.deleteAllLists(n,t,listNames.lists,i,r)}function callbackFail(n,t,i,r){consoleLog("in callbackFail with listName: "+r+" msg: "+i);i.indexOf("List '"+r+"' does not exist at site with URL")==0?createSingleList(n,t,r,!1):showMsg(i)}function callbackOverviewSuccess(n,t,i,r,u){i.length==1?(n.shortOverview=i[0].Title,n.longOverview=i[0].LongOverview):(n.shortOverview='<a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a>',n.longOverview='<a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a>');objClient.getListData(n,t,personalInfoListName,getFieldsByListName(personalInfoListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><RowLimit>1<\/RowLimit><\/View>",callbackPersonalInfoSuccess,callbackFail);updateProgressBar(++listCreatedCounter)}function callbackPersonalInfoSuccess(n,t,i,r,u){i.length==1?(n.address=i[0].Title,n.email=i[0].Email,n.phone=i[0].Phone):(n.address='<a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a>',n.email='<a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a>',n.phone='<a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a>');objClient.getListData(n,t,skillListName,getFieldsByListName(skillListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackSkillSuccess,callbackFail);updateProgressBar(++listCreatedCounter)}function callbackSkillSuccess(n,t,i,r,u){var f='<tr><td><a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a><\/td><\/tr>',e,o;if(i.length>0)for(f="",e=0;e<i.length;e++)o=0,f+="<tr>",f+="<td class='skill'>"+i[e].Title+"<\/td>",f+="<td>"+i[e].Experience+"<\/td>",f+="<\/tr>";n.skill=f;objClient.getListData(n,t,certificationListName,getFieldsByListName(certificationListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackCertificationSuccess,callbackFail);updateProgressBar(++listCreatedCounter)}function callbackCertificationSuccess(n,t,i,r,u){var f='<tr><td><a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a><\/td><\/tr>',e,o;if(i.length>0)for(f="",e=0;e<i.length;e++)o=0,f+="<tr>",f+="<td class='skill'>"+i[e].Title+"<\/td>",f+="<td>"+i[e].Completed+"<\/td>",f+="<\/tr>";n.certification=f;objClient.getListData(n,t,experienceListName,getFieldsByListName(experienceListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackExperienceSuccess,callbackFail);updateProgressBar(++listCreatedCounter)}function callbackExperienceSuccess(n,t,i,r,u){var e='<tr><td><a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a><\/td><\/tr>',f;if(i.length>0)for(e="",f=0;f<i.length;f++)e+="<tr>",e+="<td>"+i[f].Title+"<\/td>",e+="<td>"+(i[f].Company==null?"":i[f].Company.description)+"<\/td>",e+="<td>"+(i[f].Company==null?"":i[f].Company.url)+"<\/td>",e+="<\/tr>";n.experience=e;objClient.getListData(n,t,educationListName,getFieldsByListName(educationListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackEducationSuccess,callbackFail);updateProgressBar(++listCreatedCounter)}function callbackEducationSuccess(n,t,i,r,u){var e='<tr><td><a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a><\/td><\/tr>',f,o;if(i.length>0)for(e="",f=0;f<i.length;f++)o=0,e+="<tr>",e+="<td class='education'>"+i[f].Title+"<\/td>",e+="<td>"+(i[f].University==null?"":i[f].University.description)+"<\/td>",e+="<td>"+(i[f].University==null?"":i[f].University.url)+"<\/td>",e+="<td>"+i[f].Completed+"<\/td>",e+="<\/tr>";n.education=e;objClient.getListData(n,t,projectListName,getFieldsByListName(projectListName),"<View><Query><Where><Eq><FieldRef Name='Author'/><Value Type='Integer'><UserID/><\/Value><\/Eq><\/Where><\/Query><\/View>",callbackProjectSuccess,callbackFail);updateProgressBar(++listCreatedCounter)}function callbackProjectSuccess(n,t,i,r,u){var e='<tr><td><a name="add" class="no-print" href="'+document.URL.replace("/Pages/Default.aspx?","/Pages/Admin/List/new.aspx?listName="+u+"&")+'">Add<\/a><\/td><\/tr>',f,o;if(i.length>0)for(e="",f=0;f<i.length;f++)o=0,e+="<div class='project-single-height'>",e+="<div class='row'><div class='col-xs-12 col-md-5 project'>"+i[f].Title+"<\/div><div class='col-xs-12 col-md-7 project-tag'>"+i[f].Tags+"<\/div><\/div><hr class='hrLine'/>"+i[f].Description,e+="<\/div>";n.project=e;showHideFooterMenu(!0);updateProgressBar(++listCreatedCounter)}var consoleLogEnabled=getCookie("consoleLogEnabled"),listCreatedCounter=0;angular.module("sharePointService",[]).factory("sharePointService",["$q",function(n){var t={};return t.executeQuery=function(t){var i=n.defer();return t.executeQueryAsync(i.resolve,function(n,t){i.reject(t)}),i.promise},t}]);resumeBuilderApp.directive("divAlertMsg",function(){return{template:'<div class="alert alert-dismissible msg" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><span id="spanMsg"><\/span><\/div>'}});resumeBuilderApp.directive("footerMenu",function(){return{template:'<div class="col-md-6 no-print"><input type="button" value="Back to SharePoint" id="backToSharePoint" ng-click="backToSharePoint()"/><\/div><div class="col-md-6 no-print footer-menu" ng-html-compile="footerMenuLinks"><\/div>',scope:{},link:function(n,t,i){n.footerMenuLinks=i.isAdmin=="true"?'<a id="refresh" ng-click="refresh()">Refresh<\/a> | <a href="{{viewResumeUrl}}" id="viewResume">View Resume<\/a> | <a href="{{adminHomeUrl}}" id="adminHome">Admin Home<\/a> | <a href="https://spenhance.codeplex.com/discussions" target="_blank">Technical Support<\/a>':'<a id="refresh" ng-click="refresh()">Refresh<\/a> | <a href="{{adminHomeUrl}}" id="adminHome">Admin Home<\/a> | <a id="print" ng-click="print()">Print<\/a> | <a href="https://spenhance.codeplex.com/discussions" target="_blank">Technical Support<\/a>';n.viewResumeUrl=appWebUrl+"/Pages/Default.aspx?SPAppWebUrl="+appWebUrl+"&SPHostUrl="+hostWebUrl;n.backToSharePoint=function(){document.location=hostWebUrl};n.adminHomeUrl=appWebUrl+"/Pages/Admin/Default.aspx?SPAppWebUrl="+appWebUrl+"&SPHostUrl="+hostWebUrl;n.refresh=function(){refreshPage()};n.print=function(){window.print()}}}});resumeBuilderApp.directive("clickDisable",function(){return{restrict:"A",link:function(n,t){$(t).click(function(){$("input[type='button']").attr("disabled","disabled")})}}});resumeBuilderApp.directive("progressBar",function(){return{template:'<div class="progress"><div class="progress-bar" role="progressbar" aria-valuenow="{{progressBarValueNow}}" aria-valuemin="0" aria-valuemax="100" style= "width:{{progressBarValueNow}}%">Loading {{progressBarValueNow}}%<\/div><\/div>'}})